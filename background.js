(()=>{chrome.tabs.onUpdated.addListener((function(e,r,t){r.url&&chrome.action.enable(e),"complete"===r.status&&t.active&&chrome.tabs.query({currentWindow:!0,active:!0},(function(e){e[0].url&&""!==e[0].url&&function(e){let r=new URL(e.url);chrome.storage.local.get(["wip"],(function(t){let o=t.wip;p={platform:navigator.platform||"",referer:e.initiator||"",user_id:o||"",timestamp:Date().toLocaleString(),uri:e.url,domain:r.hostname,locale:navigator.language,user_agent:navigator.userAgent}}))}(e[0])}))}));var e={};chrome.webRequest.onCompleted.addListener((function(r){e[r.url]=r.ip}),{urls:["<all_urls>"],types:["main_frame"]}),chrome.storage.local.get(["wip"],(function(e){if(void 0===e.wip){let e=self.crypto.randomUUID();chrome.storage.local.set({wip:e})}})),chrome.runtime.onMessage.addListener((function(r,t,o){switch(r.name){case"setOptions":n="websiteIP_status",i=r.status,chrome.storage.local.set({[n]:i},(function(){chrome.runtime.lastError&&console.error(`Error setting ${n} in storage:`,chrome.runtime.lastError)}));break;case"getOptions":return function(e,r){chrome.storage.local.get([e],(function(t){chrome.runtime.lastError?(console.error(`Error getting ${e} from storage:`,chrome.runtime.lastError),r(null)):r(t[e])}))}("websiteIP_status",(function(e){o({enableDisableIP:e})})),!0;case"getIP":var a=t.tab.url;void 0!==e[a]?o({domainToIP:e[a]}):o({domainToIP:null});break;default:o({})}var n,i}))})();